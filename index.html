<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AGENDAMENTO DE APARELHOS</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --azul-escuro: #0a2463;
      --azul-medio: #3e92cc;
      --azul-claro: #d6eaff;
      --verde: #4caf50;
      --vermelho: #f44336;
      --cinza-escuro: #333;
      --cinza-claro: #f5f5f5;
      --branco: #ffffff;
      --branco-brilhante: rgba(255, 255, 255, 0.9);
      --verde-disponivel: #2ecc71;
      --azul-agendado: #3498db;
      --azul-selecionado: #1a5276;
      --fundo-cinza: #f0f0f0;
      --entregue: #d4edda;
      --nao-entregue: #f8d7da;
      --laranja: #ff9800;
      --roxo: #9c27b0;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(to bottom, var(--azul-escuro) 0%, var(--azul-escuro) 50%, #111 50%, #111 100%);
      color: var(--cinza-claro);
      min-height: 100vh;
      padding: 20px;
    }

    h2 {
      color: var(--branco);
      margin-bottom: 20px;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      font-size: 1.8rem;
    }

    h3 {
      color: #000000;
      margin: 0.4cm 0;
      text-align: center;
      text-transform: uppercase;
      font-size: 0.9em;
      background-color: var(--azul-claro);
      padding: 8px;
      border-radius: 5px;
    }

    .container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }

    .form-container {
      flex: 1;
      min-width: 300px;
      background-color: rgba(255, 255, 255, 0.95);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      color: var(--cinza-escuro);
      transition: transform 0.3s ease;
    }

    .form-container:hover {
      transform: translateY(-5px);
    }

    .calendar-container {
      flex: 1;
      min-width: 300px;
      background-color: rgba(255, 255, 255, 0.95);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      color: var(--cinza-escuro);
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 1.5rem;
    }

    .form-group {
      flex: 1;
      min-width: 220px;
      position: relative;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--azul-escuro);
      font-size: 0.9rem;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background-color: var(--branco);
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    .form-group select {
      cursor: pointer;
    }

    /* Estilo para dropdown com cores alternadas */
    .form-group select option:nth-child(odd) {
      background-color: var(--azul-claro);
    }
    
    .form-group select option:nth-child(even) {
      background-color: var(--branco);
    }

    .calendar {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      margin-bottom: 0.4cm;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .calendar th,
    .calendar td {
      width: 40px;
      height: 40px;
      text-align: center;
      vertical-align: middle;
      border: 1px solid #ddd;
      border-radius: 8px;
      background-color: var(--branco);
      padding: 10px;
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }

    .calendar th {
      background-color: var(--azul-claro);
      border: 1px solid #ddd;
      font-weight: 600;
    }

    .calendar td.disponivel {
      background-color: var(--verde-disponivel);
      color: white;
      cursor: default;
      border: 1px solid #ddd;
    }

    .calendar td.agendado {
      background-color: var(--azul-agendado);
      color: white;
      border: 1px solid #ddd;
      cursor: default;
    }

    .calendar td.selecionado {
      background-color: var(--azul-selecionado);
      color: white;
      font-weight: bold;
      border: 1px solid #ddd;
      cursor: default;
      transform: scale(1.05);
    }

    .calendar td.indisponivel {
      background-color: #e0e0e0;
      cursor: not-allowed;
      color: #999;
      border: 1px solid #ddd;
    }

    .calendar td:hover:not(.indisponivel) {
      opacity: 0.8;
      transform: translateY(-2px);
    }

    /* Estilos para a tabela de histórico */
    .historico-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .historico-table th,
    .historico-table td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
      word-wrap: break-word;
      overflow-wrap: break-word;
      font-size: 0.8em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .historico-table th {
      background-color: var(--azul-claro);
      color: #000;
      font-weight: bold;
      position: sticky;
      top: 0;
    }

    .historico-table td {
      color: #333;
    }

    .historico-table tr.excluido td {
      color: var(--vermelho);
      text-decoration: line-through;
    }

    .historico-table tr.entregue {
      background-color: var(--entregue);
    }

    .historico-table tr.nao-entregue {
      background-color: var(--nao-entregue);
    }

    /* Definindo larguras específicas para cada coluna */
    .historico-table th:nth-child(1),
    .historico-table td:nth-child(1) {
      width: 15%;
    }

    .historico-table th:nth-child(2),
    .historico-table td:nth-child(2) {
      width: 20%;
    }

    .historico-table th:nth-child(3),
    .historico-table td:nth-child(3) {
      width: 10%;
    }

    .historico-table th:nth-child(4),
    .historico-table td:nth-child(4) {
      width: 15%;
    }

    .historico-table th:nth-child(5),
    .historico-table td:nth-child(5) {
      width: 25%;
    }

    .historico-table th:nth-child(6),
    .historico-table td:nth-child(6) {
      width: 15%;
    }

    /* Estilos para os botões */
    .buttons-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      justify-content: center;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
      font-size: 1rem;
    }

    .btn:active {
      transform: translateY(2px);
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
    }

    .btn-cadastrar {
      background: linear-gradient(to right, var(--azul-medio), var(--azul-escuro));
      color: white;
    }

    .btn-cadastrar:hover {
      background: linear-gradient(to right, #2c7ebd, #09306b);
    }

    .btn-cadastrar:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    .btn-limpar {
      background: linear-gradient(to right, #f0f0f0, #e0e0e0);
      color: #333;
    }

    .btn-limpar:hover {
      background: linear-gradient(to right, #e0e0e0, #d0d0d0);
    }

    .btn-limpar:active {
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
    }

    .btn-excluir {
      background: none;
      border: none;
      color: var(--vermelho);
      cursor: pointer;
      font-size: 1.2rem;
      padding: 5px;
      transition: transform 0.2s;
    }

    .btn-excluir:hover {
      transform: scale(1.2);
    }
    
    .btn-editar {
      background: none;
      border: none;
      color: var(--azul-medio);
      cursor: pointer;
      font-size: 1.2rem;
      padding: 5px;
      transition: transform 0.2s;
    }

    .btn-editar:hover {
      transform: scale(1.2);
    }

    /* Estilo para o calendário pop-up */
    .datepicker-container {
      position: relative;
    }

    .datepicker-popup {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      z-index: 1000;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
      width: 300px;
    }

    .datepicker-popup.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .datepicker-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .datepicker-nav {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .datepicker-nav:hover {
      background-color: var(--azul-claro);
    }

    .datepicker-title {
      font-weight: bold;
      font-size: 1.1rem;
    }

    .datepicker-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }

    .datepicker-weekday {
      text-align: center;
      font-weight: bold;
      padding: 8px 0;
      color: var(--azul-escuro);
    }

    .datepicker-day {
      text-align: center;
      padding: 8px;
      cursor: pointer;
      border-radius: 50%;
      transition: all 0.2s;
    }

    .datepicker-day:hover {
      background-color: var(--azul-claro);
    }

    .datepicker-day.selected {
      background-color: var(--azul-medio);
      color: white;
      font-weight: bold;
    }

    .datepicker-day.disabled {
      color: #ccc;
      cursor: not-allowed;
    }

    .datepicker-today {
      font-weight: bold;
      border: 2px solid var(--azul-medio);
    }

    .datepicker-other-month {
      color: #aaa;
    }

    .datepicker-input {
      cursor: pointer;
    }

    .conflict-message {
      color: var(--vermelho);
      font-weight: bold;
      margin-top: 10px;
      text-align: center;
      display: none;
      padding: 10px;
      background-color: #ffebee;
      border-radius: 5px;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { opacity: 0.8; }
      50% { opacity: 1; }
      100% { opacity: 0.8; }
    }

    /* Estilo para o horário do professor */
    .teacher-schedule {
      margin-top: 20px;
      background-color: var(--branco);
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      display: none;
    }

    .teacher-schedule h4 {
      color: var(--azul-escuro);
      margin-bottom: 10px;
      text-align: center;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .schedule-container {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .period-schedule {
      flex: 1;
      min-width: 150px;
    }

    .period-title {
      background-color: var(--azul-claro);
      padding: 8px;
      border-radius: 5px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 8px;
    }

    .schedule-list {
      list-style-type: none;
    }

    .schedule-list li {
      padding: 6px 8px;
      margin-bottom: 5px;
      background-color: #f9f9f9;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .schedule-list li:nth-child(odd) {
      background-color: #f0f7ff;
    }

    /* Responsividade */
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }
      
      .form-row {
        flex-direction: column;
        gap: 15px;
      }
      
      .buttons-container {
        flex-direction: column;
      }
      
      .schedule-container {
        flex-direction: column;
      }
    }

    .tooltip {
      position: relative;
      cursor: help;
    }

    .tooltip::after {
      content: "ℹ️";
      margin-left: 5px;
      font-size: 0.8em;
    }

    .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.8rem;
    }

    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }

    .teacher-availability {
      background-color: var(--laranja);
      color: white;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
      display: inline-block;
      margin-top: 5px;
    }
    
    .aula-disponivel {
      background-color: var(--azul-medio);
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 0.9rem;
      display: inline-block;
      margin: 5px;
      cursor: pointer;
      transition: all 0.2s;
      border: 2px solid transparent;
    }
    
    .aula-selecionada {
      background-color: var(--verde);
      color: white;
      transform: scale(1.05);
      border: 2px solid var(--azul-escuro);
    }
    
    .aula-indisponivel {
      background-color: #e0e0e0;
      color: #999;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.9rem;
      display: inline-block;
      margin-top: 5px;
    }
    
    .day-of-week {
      font-size: 0.85em;
      color: var(--roxo);
      font-weight: bold;
      margin-top: 5px;
      text-align: center;
      display: block;
    }
    
    .info-box {
      background-color: var(--azul-claro);
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
    }
    
    .info-box h4 {
      color: var(--azul-escuro);
      margin-bottom: 10px;
      text-align: center;
    }
    
    .info-content {
      font-size: 0.9rem;
      line-height: 1.5;
    }
    
    .aulas-container {
      display: flex;
      flex-wrap: wrap;
      margin-top: 10px;
      justify-content: center;
    }
    
    .aulas-title {
      width: 100%;
      text-align: center;
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--azul-escuro);
    }
    
    .periodo-title {
      width: 100%;
      text-align: center;
      font-weight: bold;
      margin: 15px 0 8px;
      color: var(--azul-escuro);
      border-bottom: 2px solid var(--azul-medio);
      padding-bottom: 5px;
    }

    /* Estilos para a seção de agendamentos na parte inferior do calendário */
    .agendamentos-section {
      margin-top: 30px;
      background-color: var(--branco);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .agendamentos-section h3 {
      color: var(--azul-escuro);
      margin-bottom: 15px;
      text-align: center;
      background-color: var(--azul-claro);
      padding: 10px;
      border-radius: 5px;
    }

    .agendamento-item {
      background-color: #f8f9fa;
      border-left: 4px solid var(--azul-medio);
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 5px;
      transition: all 0.3s ease;
    }

    .agendamento-item:hover {
      background-color: #e9ecef;
      transform: translateX(5px);
    }

    .agendamento-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .agendamento-data {
      font-weight: bold;
      color: var(--azul-escuro);
      font-size: 1.1rem;
    }

    .agendamento-status {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: bold;
    }

    .status-agendado {
      background-color: var(--azul-agendado);
      color: white;
    }

    .status-entregue {
      background-color: var(--verde);
      color: white;
    }

    .agendamento-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      font-size: 0.9rem;
    }

    .detail-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .detail-label {
      font-weight: bold;
      color: var(--azul-escuro);
    }

    .detail-value {
      color: var(--cinza-escuro);
    }
    
    /* Novo estilo para exibição de períodos */
    .periodo-container {
      width: 100%;
      margin-bottom: 10px;
    }
    
    .aulas-periodo {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .no-aulas {
      text-align: center;
      color: #777;
      font-style: italic;
      padding: 10px;
    }
    
    .action-buttons {
      display: flex;
      gap: 8px;
      justify-content: center;
    }
    
    /* Novos estilos para períodos */
    .periodo-manha {
      background: linear-gradient(45deg, #ffecd2, #fcb69f);
    }
    
    .periodo-tarde {
      background: linear-gradient(45deg, #a1c4fd, #c2e9fb);
    }
    
    .periodo-noite {
      background: linear-gradient(45deg, #d4fc79, #96e6a1);
    }
    
    .periodo-indefinido {
      background: linear-gradient(45deg, #f6d365, #fda085);
    }
    
    .periodo-titulo {
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 20px;
      margin: 10px 0;
      display: inline-block;
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <h2>AGENDAMENTO DE APARELHOS</h2>
  <div class="container">
    <div class="form-container">
      <div class="form-row">
        <div class="form-group">
          <label>PROFESSOR: <span class="tooltip"><span class="tooltip-text">Selecione o professor para verificar sua disponibilidade</span></span></label>
          <select id="professor" onchange="atualizarEmail(); verificarDisponibilidadeProfessor(); atualizarAulasDisponiveis()">
            <option>Selecione</option>
          </select>
        </div>
        <div class="form-group">
          <label>EMAIL:</label>
          <input type="email" id="email-professor" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>APARELHO:</label>
          <select id="aparelho" onchange="atualizarMarca()">
            <option value="">Selecione</option>
            <option value="TABLET">TABLET</option>
            <option value="SMARTPHONE">SMARTPHONE</option>
            <option value="CHROMEBOOK">CHROMEBOOK</option>
            <option value="NOTEBOOK">NOTEBOOK</option>
          </select>
        </div>

        <div class="form-group">
          <label>MARCA:</label>
          <input type="text" id="marca" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>N° DE APARELHOS:</label>
          <input type="number" id="numero-aparelhos" min="1" value="1">
        </div>
        
        <div class="form-group datepicker-container">
          <label>DATA:</label>
          <input type="text" id="data-selecionada" class="datepicker-input" readonly placeholder="Clique para selecionar" onchange="atualizarAulasDisponiveis()">
          <div class="datepicker-popup" id="datepickerPopup">
            <div class="datepicker-header">
              <button class="datepicker-nav" id="prevMonth">&lt;</button>
              <div class="datepicker-title" id="datepickerMonthYear"></div>
              <button class="datepicker-nav" id="nextMonth">&gt;</button>
            </div>
            <div class="datepicker-grid" id="datepickerWeekdays"></div>
            <div class="datepicker-grid" id="datepickerDays"></div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>SELECIONE A TURMA:</label>
          <select id="studentClass" class="form-control" required onchange="atualizarSala(); verificarDisponibilidadeProfessor()">
            <option value="">Selecione a turma</option>
            <option value="6° ANO A MANHA">6° ANO A MANHA</option>
            <option value="6° ANO B MANHA">6° ANO B MANHA</option>
            <option value="6° ANO C MANHA">6° ANO C MANHA</option>
            <option value="6° ANO D MANHA">6° ANO D MANHA</option>
            <option value="6° ANO E TARDE">6° ANO E TARDE</option>
            <option value="6° ANO F TARDE">6° ANO F TARDE</option>
            <option value="7° ANO A TARDE">7° ANO A TARDE</option>
            <option value="7° ANO B TARDE">7° ANO B TARDE</option>
            <option value="7° ANO C TARDE">7° ANO C TARDE</option>
            <option value="7° ANO D TARDE">7° ANO D TARDE</option>
            <option value="7° ANO E TARDE">7° ANO E TARDE</option>
            <option value="7° ANO F TARDE">7° ANO F TARDE</option>
            <option value="8° ANO A TARDE">8° ANO A TARDE</option>
            <option value="8° ANO B TARDE">8° ANO B TARDE</option>
            <option value="8° ANO C TARDE">8° ANO C TARDE</option>
            <option value="8° ANO D TARDE">8° ANO D TARDE</option>
            <option value="8° ANO E TARDE">8° ANO E TARDE</option>
            <option value="9° ANO A TARDE">9° ANO A TARDE</option>
            <option value="9° ANO B TARDE">9° ANO B TARDE</option>
            <option value="9° ANO C TARDE">9° ANO C TARDE</option>
            <option value="9° ANO D TARDE">9° ANO D TARDE</option>
            <option value="1ª SERIE A MANHA">1ª SERIE A MANHA</option>
            <option value="1ª SERIE B MANHA">1ª SERIE B MANHA</option>
            <option value="1ª SERIE C MANHA">1ª SERIE C MANHA</option>
            <option value="1ª SERIE D MANHA">1ª SERIE D MANHA</option>
            <option value="1ª SERIE E MANHA">1ª SERIE E MANHA</option>
            <option value="1ª SERIE F MANHA">1ª SERIE F MANHA</option>
            <option value="1ª SERIE G TARDE">1ª SERIE G TARDE</option>
            <option value="1ª SERIE H NOITE">1ª SERIE H NOITE</option>
            <option value="1ª SERIE I NOITE">1ª SERIE I NOITE</option>
            <option value="2ª SERIE A MANHA">2ª SERIE A MANHA</option>
            <option value="2ª SERIE B MANHA">2ª SERIE B MANHA</option>
            <option value="2ª SERIE C MANHA">2ª SERIE C MANHA</option>
            <option value="2ª SERIE D MANHA">2ª SERIE D MANHA</option>
            <option value="2ª SERIE E MANHA">2ª SERIE E MANHA</option>
            <option value="2ª SERIE F NOITE">2ª SERIE F NOITE</option>
            <option value="2ª SERIE G NOITE">2ª SERIE G NOITE</option>
            <option value="2ª SERIE H NOITE">2ª SERIE H NOITE</option>
            <option value="2ª SERIE I NOITE">2ª SERie I NOITE</option>
            <option value="3ª SERIE A MANHA">3ª SERIE A MANHA</option>
            <option value="3ª SERIE B MANHA">3ª SERIE B MANHA</option>
            <option value="3ª SERIE C MANHA">3ª SERIE C MANHA</option>
            <option value="3ª SERIE D NOITE">3ª SERIE D NOITE</option>
            <option value="3ª SERIE E NOITE">3ª SERIE E NOITE</option>
            <option value="3ª SERIE F NOITE">3ª SERIE F NOITE</option>
            <option value="3ª SERIE G NOITE">3ª SERIE G NOITE</option>
            <option value="4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA">4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA</option>
          </select>
        </div>

        <div class="form-group">
          <label>SALA:</label>
          <input type="text" id="sala" readonly>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group" onclick="abrirRelogio('hora-retirada')" style="cursor: pointer;">
          <label for="hora-retirada">RETIRADA:</label>
          <input type="time" id="hora-retirada" required>
        </div>
        <div class="form-group" onclick="abrirRelogio('hora-entrega')" style="cursor: pointer;">
          <label for="hora-entrega">ENTREGA:</label>
          <input type="time" id="hora-entrega">
        </div>
      </div>

      <div class="form-group">
        <label for="aula">AULAS DISPONÍVEIS:</label>
        <div id="aula-info">
          <span class="aula-indisponivel">Selecione um professor e uma data para ver as aulas disponíveis</span>
        </div>
        <div class="aulas-container" id="aulas-container">
          <!-- Botões de aula serão gerados dinamicamente aqui -->
        </div>
      </div>

      <div class="teacher-schedule" id="teacherSchedule">
        <h4>HORÁRIO DO PROFESSOR</h4>
        <div class="schedule-container">
          <div class="period-schedule">
            <div class="period-title">MANHÃ</div>
            <ul class="schedule-list" id="manhaSchedule"></ul>
          </div>
          <div class="period-schedule">
            <div class="period-title">TARDE</div>
            <ul class="schedule-list" id="tardeSchedule"></ul>
          </div>
          <div class="period-schedule">
            <div class="period-title">NOITE</div>
            <ul class="schedule-list" id="noiteSchedule"></ul>
          </div>
        </div>
      </div>

      <div class="info-box">
        <h4>INFORMAÇÕES</h4>
        <div class="info-content">
          <p><i class="fas fa-info-circle"></i> Selecione um professor e uma data para ver as aulas disponíveis.</p>
          <p><i class="fas fa-check-circle"></i> As aulas mostradas correspondem ao dia da semana selecionado.</p>
          <p><i class="fas fa-exclamation-triangle"></i> Clique em uma aula para selecioná-la para agendamento.</p>
          <p><i class="fas fa-plus-circle"></i> É possível selecionar múltiplas aulas clicando nelas.</p>
        </div>
      </div>

      <div class="conflict-message" id="conflictMessage">
        ⚠️ CONFLITO: Já existe um agendamento para esta turma, data e aula!
      </div>

      <div class="buttons-container">
        <button class="btn btn-cadastrar" onclick="cadastrarAgendamento()">CADASTRAR</button>
        <button class="btn btn-limpar" onclick="limparFormulario()">LIMPAR</button>
      </div>
    </div>

    <div class="calendar-container">
      <div style="margin-bottom: 20px; display: flex; gap: 15px;">
        <select id="monthSelect" class="form-control"></select>
        <select id="yearSelect" class="form-control"></select>
      </div>

      <table class="calendar">
        <thead>
          <tr>
            <th>Dom</th>
            <th>Seg</th>
            <th>Ter</th>
            <th>Qua</th>
            <th>Qui</th>
            <th>Sex</th>
            <th>Sáb</th>
          </tr>
        </thead>
        <tbody id="calendarBody">
          <!-- Dias serão inseridos via JavaScript -->
        </tbody>
      </table>

      <!-- Seção de agendamentos na parte inferior do calendário -->
      <div class="agendamentos-section" id="agendamentosSection">
        <h3><i class="fas fa-calendar-check"></i> AGENDAMENTOS DO MÊS</h3>
        <div id="agendamentos-lista">
          <!-- Agendamentos serão inseridos dinamicamente aqui -->
        </div>
      </div>

      <h3>HISTÓRICO DE AGENDAMENTOS</h3>
      <table class="historico-table">
        <thead>
          <tr>
            <th>DATA</th>
            <th>TURMA</th>
            <th>N° APARELHOS</th>
            <th>APARELHO</th>
            <th>PROFESSOR</th>
            <th>AULA(s)</th>
            <th>ENTREGA</th>
            <th>AÇÃO</th>
          </tr>
        </thead>
        <tbody id="historico-body">
          <!-- Histórico dinâmico -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Dados dos professores
    const teacherEmails = {
      "ALEX LUTH PEREIRA MARANHAO": "luth@prof.educacao.sp.gov.br",
      "ALEXSANDRA PAULA VARELLA DE SOUZA": "avarella@prof.educacao.sp.gov.br",
      "ALISON VASCONCELOS BESERRA": "alisonv@prof.educacao.sp.gov.br",
      "AMAURI TEODORO DE OLIVEIRA": "amaurit@prof.educacao.sp.gov.br",
      "ANA PAULA DOS SANTOS": "paulasantosa@prof.educacao.sp.gov.br",
      "ANDREIA DOS SANTOS FREITAS": "sanfreitas@prof.educacao.sp.gov.br",
      "ANDREIA MADUREIRA REIS": "andreiamadureira@prof.educacao.sp.gov.br",
      "ANTONIO CARLOS DE OLIVEIRA": "antoniocarloso@prof.educacao.sp.gov.br",
      "ANTONIO RAMOS DE ARAUJO": "antonioramosaraujo@prof.educacao.sp.gov.br",
      "ANTONIO WILTON WANDERLEY CABRAL": "antoniowilton@prof.educacao.sp.gov.br",
      "AUGUSTO LINO PESSOA NETO": "augustolino@prof.educacao.sp.gov.br",
      "AUREA MARIA DE JESUS MARQUES": "aureamaria@prof.educacao.sp.gov.br",
      "CAROLINA PERNOMIAN PARUSSOLO": "carolinapernomian@prof.educacao.sp.gov.br",
      "CASSIA OLIVEIRA ANTONIAZI": "cassiaosilva@prof.educacao.sp.gov.br",
      "CLAUDINEIA DE AGUIAR LIMA": "aguiarl@prof.educacao.sp.gov.br",
      "DANIEL DE FREITAS ALMEIDA": "danielalmeida@prof.educacao.sp.gov.br",
      "DANIEL LOPES BARBOSA": "daniellopesbarbosa@prof.educacao.sp.gov.br",
      "DANIELA FERREIRA LIMA": "danielaflima@prof.educacao.sp.gov.br",
      "DANIELLE LUCIA BATISTA DE ALMEIDA": "danielelucia@prof.educacao.sp.gov.br",
      "EDIANE VIEIRA DA SILVA": "ediane@prof.educacao.sp.gov.br",
      "EDILEUSA NUNES PEREIRA": "edileusa@prof.educacao.sp.gov.br",
      "EDUARDO HENRIQUE DA FONSECA": "henriquefonseca@prof.educacao.sp.gov.br",
      "ELIANE SANTOS SILVA": "essantos@prof.educacao.sp.gov.br",
      "ELIAS MONTEIRO DA SILVA": "elias1@prof.educacao.sp.gov.br",
      "ELISABETE APARECIDA PIRES": "elisabetepires@prof.educacao.sp.gov.br",
      "ELZA DE FARIA PEREIRA": "elzafariapereira@prof.educacao.sp.gov.br",
      "EMERSON GABLER DE ALMEIDA": "egabler@prof.educacao.sp.gov.br",
      "EUZELI ARAUJO DE OLIVEIRA": "euzeli@prof.educacao.sp.gov.br",
      "FABIANO AUGUSTO PIEDADE": "fabianoaugusto@prof.educacao.sp.gov.br",
      "FABIO CAMILO": "camilof@prof.educacao.sp.gov.br",
      "FERNANDO JOSE DA SILVA FILHO": "fernandojs@prof.educacao.sp.gov.br",
      "FLAVIA CRISTINA APARECIDA BICHLER": "flaviacri@prof.educacao.sp.gov.br",
      "FLAVIO CARDOSO FLEURY": "flaviofleury@prof.educacao.sp.gov.br",
      "FRANCISCA EDIVANIA DE MORAIS COSTA": "fedivania@prof.educacao.sp.gov.br",
      "GABRIELA SERIGHELLI DE MELO": "gabrielaserighelli@prof.educacao.sp.gov.br",
      "GELSON DE ALMEIDA BATISTA": "gelsonalmeida@prof.educacao.sp.gov.br",
      "GENILTON DE OLIVEIRA SILVA": "genilton@prof.educacao.sp.gov.br",
      "GIANI CRISTINA DO PRADO": "gianiprado@prof.educacao.sp.gov.br",
      "INGRYD CAROLINA SUGUIMOTO VIEIRA": "ingryd@prof.educacao.sp.gov.br",
      "IVANILDES DOS SANTOS OSHIKAWA": "oshikawa@prof.educacao.sp.gov.br",
      "JANINA DOS PASSOS BRAGA DE ALMEIDA": "janinabraga@prof.educacao.sp.gov.br",
      "JOSE APARECIDO DA SILVA": "joseaparecidosilva@prof.educacao.sp.gov.br",
      "JUAREZ GOMES DE MAGALHAES FILHO": "juarezgomes@prof.educacao.sp.gov.br",
      "JUREMA SOLEDADE FURINI SANTOS": "juremas@prof.educacao.sp.gov.br",
      "KATIUSCIA ALVES BOMFIM": "katiusciabomfim@prof.educacao.sp.gov.br",
      "LUANA CAROLINE ALVES LIMA": "luanalima01@prof.educacao.sp.gov.br",
      "LUANA DE FREITAS SILVA": "luanafreitas@prof.educacao.sp.gov.br",
      "LUCIANA NOVAIS CORREIA SANTOS": "novaiscorreia@prof.educacao.sp.gov.br",
      "LUCIANO MOREIRA DE AZEVEDO": "lucianomoreira@prof.educacao.sp.gov.br",
      "MARCIEL DA SILVA": "marcielsilva@prof.educacao.sp.gov.br",
      "MARIA HELENA CUNHA MORO": "marcunha@prof.educacao.sp.gov.br",
      "MARIA QUITÉRIA FERREIRA DOS SANTOS": "quiteriasantos@prof.educacao.sp.gov.br",
      "MARINA DA CONCEICAO FRANCISCO SILVA": "marinafrancisco@prof.educacao.sp.gov.br",
      "MAURICIO DE BARROS SANTOS": "mauriciobsantos@prof.educacao.sp.gov.br",
      "MICHELE DE PINHO MORAES": "michelepinho@prof.educacao.sp.gov.br",
      "MOISES ANTONIO DE BARROS": "moisesbarros@prof.educacao.sp.gov.br",
      "PAULA ARMANI VILA": "paulaarmani@prof.educacao.sp.gov.br",
      "PAULO ROBERTO DA SILVA ITO": "pauloito@prof.educacao.sp.gov.br",
      "PEDRO ZANOTTI FILHO": "pedrozanotti@prof.educacao.sp.gov.br",
      "RAUL PEREIRA VILERA JUNIOR": "vilera@prof.educacao.sp.gov.br",
      "REGIANE CURTI DE SOUZA OLIVEIRA": "regianecurti@prof.educacao.sp.gov.br",
      "REGINA DA SILVA CASTRO": "reginasilvacastro@prof.educacao.sp.gov.br",
      "RICARDO AMERICO DA SILVA": "ricardoamerico@prof.educacao.sp.gov.br",
      "ROBERTO SALGADO": "robertosalgado@prof.educacao.sp.gov.br",
      "RODRIGO VIEIRA": "rodrigovieira1@prof.educacao.sp.gov.br",
      "ROSANGELA CAFASSO MOREIRA": "cafasso@prof.educacao.sp.gov.br",
      "ROSIMERY DE SOUZA PESSOA": "rosimerypessoa@prof.educacao.sp.gov.br",
      "ROSMARA DA SILVA CARDOSO": "rosmaracardoso@prof.educacao.sp.gov.br",
      "SANDRA CRISTINA MACEDO MORAES": "sandracristinamacedo@prof.educacao.sp.gov.br",
      "SELMA GOMES DA SILVA": "selmagomess@prof.educacao.sp.gov.br",
      "SERGIO AGRIPINO VILLA NOVA": "sergioagripino@prof.educacao.sp.gov.br",
      "SOLANGE ALMEIDA DA SILVA": "almeidafazio@prof.educacao.sp.gov.br",
      "SUZINEIDE SILVA DE FREITAS": "suzineidefreitas@prof.educacao.sp.gov.br",
      "THIAGO FABIANO BRITO": "thiagofabiano@prof.educacao.sp.gov.br",
      "TITTO AUGUSTO NASCIMENTO SILVA": "titto@prof.educacao.sp.gov.br",
      "VANDERSON HYPPOLITO": "vhypolito@prof.educacao.sp.gov.br",
      "VANESSA IVETE GOMES DOS SANTOS": "vanessaivete@prof.educacao.sp.gov.br",
      "VANIA PENHA DE BARROS": "vaniapenha@prof.educacao.sp.gov.br",
      "VIVIANE LEAL CAMERA DE MORAES": "camera@prof.educacao.sp.gov.br",
      "WILSON RODRIGUES MOTA": "wmota@prof.educacao.sp.gov.br"
    };
    
    // Marcas dos aparelhos
    const marcas = {
      "TABLET": "SAMSUNG",
      "SMARTPHONE": "SAMSUNG",
      "CHROMEBOOK": "ACER",
      "NOTEBOOK": "POSITIVO"
    };

    // Salas por turma e período
    const salasPorTurmaPeriodo = {
      // 6° ANO
      "6° ANO A MANHA": "Sala 1",
      "6° ANO B MANHA": "Sala 2",
      "6° ANO C MANHA": "Sala 3",
      "6° ANO D MANHA": "Sala 4",
      "6° ANO E TARDE": "Sala 1",
      "6° ANO F TARDE": "Sala 2",
      
      // 7° ANO
      "7° ANO A TARDE": "Sala 3",
      "7° ANO B TARDE": "Sala 4",
      "7° ANO C TARDE": "Sala 5",
      "7° ANO D TARDE": "Sala 6",
      "7° ANO E TARDE": "Sala 7",
      "7° ANO F TARDE": "Sala 8",
      
      // 8° ANO
      "8° ANO A TARDE": "Sala 9",
      "8° ANO B TARDE": "Sala 10",
      "8° ANO C TARDE": "Sala 12",
      "8° ANO D TARDE": "Sala 13",
      "8° ANO E TARDE": "Sala 14",
      
      // 9° ANO
      "9° ANO A TARDE": "Sala 15",
      "9° ANO B TARDE": "Sala 16",
      "9° ANO C TARDE": "Sala 17",
      "9° ANO D TARDE": "Sala 18",
      
      // 1ª SÉRIE
      "1ª SERIE A MANHA": "Sala 10",
      "1ª SERIE B MANHA": "Sala 11",
      "1ª SERIE C MANHA": "Sala 12",
      "1ª SERIE D MANHA": "Sala 13",
      "1ª SERIE E MANHA": "Sala 14",
      "1ª SERIE F MANHA": "Sala 15",
      "1ª SERIE G TARDE": "Sala 9",
      "1ª SERIE H NOITE": "Sala 9",
      "1ª SERIE I NOITE": "Sala 602",
      
      // 2ª SÉRIE
      "2ª SERIE A MANHA": "Sala 5",
      "2ª SERIE B MANHA": "Sala 6",
      "2ª SERIE C MANHA": "Sala 7",
      "2ª SERIE D MANHA": "Sala 8",
      "2ª SERIE E MANHA": "Sala 9",
      "2ª SERIE F NOITE": "Sala 1",
      "2ª SERIE G NOITE": "Sala 2",
      "2ª SERIE H NOITE": "Sala 3",
      "2ª SERIE I NOITE": "Sala 4",
      
      // 3ª SÉRIE
      "3ª SERIE A MANHA": "Sala 16",
      "3ª SERIE B MANHA": "Sala 17",
      "3ª SERIE C MANHA": "Sala 18",
      "3ª SERIE D NOITE": "Sala 5",
      "3ª SERIE E NOITE": "Sala 6",
      "3ª SERIE F NOITE": "Sala 7",
      "3ª SERIE G NOITE": "Sala 8",
      
      // ADMINISTRAÇÃO
      "4050 - ADMINISTRAÇÃO - 2ª SERIE A MANHA": "Laboratório 1"
    };

   // Horários dos professores (organizados por dias da semana)
   const horariosProfessores = {
      ".": {
        "SEG": [],
        "TER": [],
        "QUA": [],
      },
      "ADEMAR": {
        "SEG": ["1D", "1E", "1E", "9A", "9A", "9C", "9C", "9D", "9A"],
        "TER": ["1F", "1F", "1B", "9D", "2F", "2H", "1H", "1H"],
        "QUA": ["1B", "1A", "1A"],
        "QUI": ["1D", "1C", "1C", "9B", "9D"],
        "SEX": ["9C", "9B", "9B", "1G", "1G", "2F", "2G", "2G", "2H"],
      },
      "ALISSON": {
        "SEG": ["6A", "6D", "6B", "1F", "6A", "6A"],
        "TER": ["1D", "6C", "1B"],
        "QUA": ["1B/BIO", "3C/PV", "6C/CIÊ", "1E/BIO", "8A", "8A", "7E/PV", "7C/PV"],
        "QUI": ["6B", "6B", "1C", "6C", "1F", "6D", "8A", "8A", "7D/PV"],
        "SEX": ["1E", "1A", "1A", "1C", "6D/C", "1D"],
      },
      "ANDRÉ": {
        "SEG": ["X", "X", "X", "X", "X"],
        "TER": ["X", "X", "X", "X", "X"],
        "QUA": ["X", "X", "X", "X", "X"],
        "QUI": ["X", "X", "X", "X", "X"],
        "SEX": ["X", "X", "X", "X", "X"],
      },
      "ANDRÉIA": {
        "SEG": ["1E", "1F", "1D", "2C", "1C", "2D"],
        "TER": ["1F/R", "1D", "1F", "1E", "1C", "1F/R"],
        "QUA": ["2C/R", "1D", "1C", "1C", "1E", "1C/R"],
        "QUI": ["1D/R", "1E", "1B/R", "1E/R", "1D/R", "1F"],
        "SEX": ["2D/R", "1E", "1C", "1F", "1D", "1B/R"],
      },
      "ANTONIO": {
        "QUI": ["3G", "2F", "2F", "2G", "2G"],
        "SEX": ["3G", "2H", "2H", "1I", "1I"],
      },
      "ANTONIO CARLOS": {
        "SEG": ["2B", "2B", "2E", "2E"],
        "TER": ["2C", "2C", "2D", "2D", "2A"],
        "QUA": ["2D", "2D", "2E", "2E"],
        "QUI": ["2A", "2A"],
        "SEX": ["2C", "2C", "2A", "2B", "2B"],
      },
      "BETE": {
        "SEG": ["1A", "1A", "1A", "1E", "1B", "1B"],
        "TER": ["1E/EF", "1E/EF", "1D", "1D", "1B", "1A"],
        "QUA": ["1C/EF", "1C/EF", "1E", "1E", "1D/EF", "1D/EF"],
        "QUI": ["1C", "1C", "1E", "1B", "1A/EF", "1A/EF"],
        "SEX": ["1B/EF", "1B/EF", "1D", "1D", "1C", "1C", "1G", "1G"],
      },
      "CAROL": {
        "SEG": ["1G", "1G", "7A", "7A"],
        "TER": ["9D", "9D", "9A", "7B", "7B"],
        "QUA": ["9C", "9C", "7B", "7A"],
        "QUI": ["9A", "9B", "9B", "9C", "9D"],
        "SEX": ["9B", "9C", "9D", "9B", "9A", "9A"],
      },
      "CASSIA": {
        "SEG": ["8C", "8E", "8E", "8B", "8B", "8B"],
        "TER": ["8D", "8D", "8B", "8C"],
        "QUA": ["8D", "8D", "8E", "8E", "8C", "8C"],
      },
      "DANIEL": {
        "SEG": ["6C", "6C", "2C", "6D", "3C", "3C", "6E", "6E"],
        "TER": ["2ADM/H", "2ADM/H", "6A", "2C", "2D/L", "2D/L"],
        "QUI": ["2D", "2D", "6D", "6A", "3B", "3B"],
        "SEX": ["3A", "3A", "2C/L", "2C/L", "2E", "2E"],
      },
      "DANIEL FR": {
        "QUA": ["1H", "1H"],
      },
      "DANIEL FREITAS": {
        "SEG": ["9B", "9B", "9D", "1G", "1G"],
        "TER": ["9A", "9B", "8E/EF", "8E/EF", "9C"],
        "QUA": ["9A", "9D", "9D", "9B", "9B"],
        "QUI": ["9C", "9A", "1G", "1G", "9C", "1H", "1H"],
        "SEX": ["9A", "9A", "9C", "9C", "9D", "9D"],
      },
      "DANIEL LOPES": {
        "QUA": ["6B", "6B", "2A", "2A", "2B", "2B"],
      },
      "DANIELA": {
        "SEG": ["1C", "1C", "6A", "6A", "6D", "6D", "", "7D", "7C", "9A", "7E", "7E", "7C"],
        "TER": ["6B", "6B", "6C", "6C", "1D", "1D", "7D", "7B", "7B", "7A", "1G", "1G", "1H"],
        "QUA": ["1A", "1A", "9D", "7A"],
        "SEX": ["1F", "1F", "1B", "1B", "1E", "1E"],
      },
      "DANIELLE": {
        "TER": ["3F", "2F", "3G"],
        "QUA": ["3E", "3D"],
        "QUI": ["2F", "3E", "3G", "3D", "3F"],
      },
      "EDIANE": {
        "SEG": ["7C", "7B", "6F/R", "6F/R", "9C/O", "9D/O", "3F", "3F", "2G", "2G", "2H"],
        "TER": ["7B", "7D", "7C", "9B/OP", "6E/R", "9B/OP", "2G", "2F", "2F", "3E/OP", "3E/OP"],
        "QUA": ["9C/OP", "7B", "2H", "2H", "2H", "2F", "2F"],
        "QUI": ["2ADM", "2ADM", "2ADM", "6F", "7D", "9D/OP", "7D", "7C", "7D"],
        "SEX": ["6E/R", "7C", "6F", "6F", "7B", "6F", "2G", "3G/OP", "3G/OP", "3D/OP", "3D/OP"],
      },
      "EDIVANIA": {
        "QUI": ["9D"],
        "SEX": ["9D"],
      },
      "EDIVÂNIA": {
        "SEG": ["1F", "1F", "2B/EMP"],
        "QUI": ["1F", "2E/EF", "1F", "2E/EF", "7F", "7E", "7E", "7F"],
      },
      "EDUARDO": {
        "QUA": ["7C", "8B", "7D", "8B", "7D", "7C"],
      },
      "ELIANE": {
        "SEG": ["1G", "1G"],
        "TER": ["6A", "6A", "2A", "2A", "2E", "2E"],
        "QUA": ["6A", "3B/PV", "6B/PV", "6A/PV", "6B", "6D"],
        "QUI": ["6C", "6C", "6C", "6B", "6B", "3A/PV"],
        "SEX": ["6D", "2B", "2B", "6D/PV", "2C", "2C"],
      },
      "ELIANE CONTI": {
        "SEG": ["3C/EMP"],
        "QUI": ["3C/EMP"],
      },
      "ELIANE SANTOS": {
        "SEG": ["2D", "2D", "6D", "6C/PV", "2ADM/G", "2ADM/G", ""],
      },
      "ELIAS": {
        "SEG": ["2E", "2E", "3B", "3B", "2C", "2C", "9B", "1H/Q", "1H/Q", "1H/EF", "1H/EF"],
        "TER": ["1C", "1C", "2ADM/Q", "2ADM/Q", "3A", "3A"],
        "QUA": ["2B", "2B", "1A", "1A", "2A", "1F", "9B/OM"],
        "QUI": ["1B", "1B", "3C", "3C", "1E", "1E", "9A", "8E/PV", "9A", "8D/PV"],
        "SEX": ["1D", "1D", "1F", "2A", "2D", "2D", "1G", "1G", "9C", "9C", "1H/F", "1H/F"],
      },
      "EUZELI": {
        "SEG": ["3B", "1E", "1E", "2D", "2B"],
        "QUA": ["1B", "1B", "1D", "1D", "1F"],
        "QUI": ["1A", "1A", "2ADM", "2C", "2A"],
        "SEX": ["1C", "1C", "2E", "3A", "1F"],
      },
      "EVENTUAL": {
        "QUI": ["1ª", "2ª", "3ª", "4ª", "5ª", "6ª"],
      },
      "EVENTUAL:": {
        "SEG": ["1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª"],
        "TER": ["1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª"],
        "QUA": ["1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª"],
        "QUI": ["1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª"],
        "SEX": ["1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª", "6ª", "1ª", "2ª", "3ª", "4ª", "5ª"],
      },
      "FLÁVIA": {
        "SEG": ["X", "X", "X", "X", "X", "X"],
        "TER": ["X", "X", "X", "X", "X", "X"],
        "QUA": ["X", "X", "X", "X", "X", "X"],
        "QUI": ["X", "X", "X", "X", "X", "X"],
        "SEX": ["X", "X", "X", "X", "X", "X"],
      },
      "FÁBIO": {
        "SEG": ["1I", "2F", "1I", "3D", "1I"],
        "TER": ["3D", "3E", "2H", "2H", "2F"],
        "QUA": ["2G", "3E", "2F", "2G", "3E"],
        "QUI": ["2H", "3D", "2G", "1I", "2H"],
        "SEX": ["3E", "3D", "2F", "2G"],
      },
      "GELSON": {
        "SEG": ["8B"],
        "TER": ["2D/EF", "2D/EF", "3C/OM", "3C/OM", "3B/OM", "3B/OM", "8A"],
        "QUA": ["8A"],
        "QUI": ["1F", "8B"],
        "SEX": ["1F", "8B", "8B", "8A", "8A", "8A", "8B"],
      },
      "GENILTON": {
        "TER": ["7E", "7E"],
        "QUA": ["7D", "6F", "7B/PV", "6E", "7F", "7D"],
        "QUI": ["7C", "7C", "6F", "6F", "6E", "6E"],
        "SEX": ["7C", "7E", "7A/PV", "7D", "7F", "7F"],
      },
      "GISLENE": {
        "SEX": ["6B", "6A", "6B", "6A"],
      },
      "GUSTAVO": {
        "SEG": ["7F/AR", "1I"],
        "QUI": ["9C/AR", "7F/AR"],
      },
      "INGRYD": {
        "SEG": ["8E", "8D", "8D", "8E", "6E", "6E"],
        "TER": ["8C", "6F", "8D", "8D"],
        "QUA": ["6F", "6E", "6E", "6F", "6F", "8E"],
        "QUI": ["8C", "8C", "6E"],
        "SEX": ["8E", "8C", "8C", "8E", "6F", "8D"],
      },
      "JANINA": {
        "SEG": ["2ADM/B", "2ADM/B", "2B"],
        "TER": ["2A", "2A", "2B"],
        "QUA": ["3C/BIOT", "3C/BIOT", "2C", "2C"],
        "QUI": ["3A", "3A", "3B", "3B", "3D", "3F", "3D"],
        "SEX": ["2E", "2D", "2D", "2E", "3E", "3E", "3F"],
      },
      "JUAREZ": {
        "SEG": ["2H", "2H", "3F", "3E", "3E"],
        "TER": ["3A", "3A", "3C", "3C", "2H/Q", "3D", "3D", "2G", "2G"],
        "QUA": ["1E", "1E", "1F", "2F/FÍS", "2G", "2G", "1I", "1I"],
        "QUI": ["1F", "1D", "1D"],
        "SEX": ["3B", "3B", "1I", "1I", "3F", "2H/Q", "2F"],
      },
      "KATIUSCIA": {
        "SEG": ["1A", "1A", "8A", "9C", "8B", "8C", "8E", "8E"],
        "TER": ["7C", "7A", "7A", "7D", "7D", "8B"],
        "QUA": ["9D", "9D", "9A", "9A", "7E", "7E"],
        "QUI": ["7B", "9B", "9C", "7B", "9B", "8A"],
        "SEX": ["8C", "7F", "7F", "8D", "8D", "7C"],
      },
      "LUANA": {
        "SEG": ["9C", "7A", "7A", "9A", "9B", "9B"],
        "TER": ["6D", "6B", "6A", "9C", "9C", "1G", "1G", "9D", "9D"],
        "QUA": ["6C", "6D", "6C", "9A", "9B", "9B", "9C", "1G", "1G"],
        "QUI": ["6A", "6B", "9D", "7A", "7A", "9D", "9A", "9A"],
      },
      "LUANA ADM": {
        "QUA": ["2ADM", "2ADM", "2ADM", "2ADM"],
        "QUI": ["2ADM", "2ADM"],
        "SEX": ["2ADM"],
      },
      "LUCIANA": {
        "SEG": ["3G", "3G", "3D", "3F", "3F"],
        "TER": ["1I", "1I", "3E", "3D", "3D"],
        "QUA": ["3E", "3F", "3F", "3G", "3G"],
        "QUI": ["3D", "1I", "1I", "3E", "3E"],
      },
      "LUCIANO": {
        "SEG": ["8A", "8A", "8D", "9A", "9C"],
        "TER": ["7E", "8B", "9C", "7E"],
        "QUA": ["8C", "9B", "8B", "9D"],
        "QUI": ["7F", "7F", "8C", "7E", "9B"],
        "SEX": ["7F", "9D", "8D", "9A", "8E", "8E"],
      },
      "MARA": {
        "TER": ["1G", "9A", "9D", "8A", "8E"],
        "QUA": ["8D", "8C", "9C", "9C"],
        "QUI": ["8A/PV", "8E", "8A", "1G"],
        "SEX": ["9D", "8D", "9A", "8C", "9B", "9B"],
      },
      "MARCIEL": {
        "SEG": ["7E", "7E", "7B", "9B/PV", "8C", "8C"],
        "TER": ["9A/PV", "8E", "8E", "8A", "7C", "7D"],
        "QUA": ["8C", "7D", "7F", "7F", "8D", "8D"],
        "QUI": ["9C/PV", "8D", "8E", "8B", "8B", "7B"],
        "SEX": ["8A", "8A", "8B", "7C", "7A", "7A", "3D", "3D"],
      },
      "MARINA": {
        "SEG": ["6B", "6A", "6B/EF", "6B/EF"],
        "TER": ["6D", "6D", "6D", "6B", "6A", "6B", "7A"],
        "QUA": ["6C", "6C", "6C", "6B", "6A/EF", "6A/EF", "7A", "7A"],
        "QUI": ["6D", "6D", "6A", "6D/EF", "6D/EF", "6A", "7A", "7B/EF", "7B/EF", "7A", "7A/EF", "7A/EF"],
        "SEX": ["6C", "6C", "6A", "6B", "6C/EF", "6C/EF"],
      },
      "MARINA ESP": {
        "SEG": ["6F", "6F", "6E", "6E"],
      },
      "MAURÍCIO": {
        "SEG": ["2C/EF", "2A/EF", "2ADM/M.A", "2ADM/M.A", "2A/MAT"],
        "TER": ["2C/EF", "2B/EF", "2ADM/M", "2ADM/M"],
        "QUA": ["2A"],
        "QUI": ["2A"],
        "SEX": ["2A", "2A", "2ADM", "2ADM", "2ADM", "2B"],
      },
      "MOISÉS": {
        "SEG": ["3E", "3E", "3G", "3G", "3D"],
        "TER": ["3E/OM", "3G", "3G", "3F/OM", "3F/OM"],
        "QUA": ["3G/OM", "3D/OM", "3D/OM", "3F", "3F"],
        "QUI": ["2G/EF", "2G/EF", "3F/OM", "2F/EF", "2F/EF"],
        "SEX": ["3F", "3F", "3G", "3G"],
      },
      "NILDES": {
        "SEG": ["3C", "2C", "2D", "3A", "2D", "3A"],
        "TER": ["2B", "3A/OM", "3B", "3B", "2C", "2C", "8A", "8A"],
        "QUA": ["3B", "2C", "3C", "2D", "3A/O M", "3B"],
        "QUI": ["2E", "2E", "2B", "2B", "3A", "2E"],
        "SEX": ["2B", "2E", "3C", "2D", "3A", "3C"],
      },
      "PAULO": {
        "SEG": ["2G", "1I", "2H", "2F"],
        "TER": ["2E", "2E", "2E/L", "2E/L", "6E", "6F", "8C"],
        "QUA": ["1F/FIL", "1F/FIL", "2D/OR", "2D/SOC", "2D/SOC", ""],
        "QUI": ["2B", "2B", "2C/OR", "2E/OR", "2C", "2C"],
        "SEX": ["2ADM", "2ADM", "1E/F", "1E/F", "2A/S", "2A/S", "2H", "2G", "2F"],
      },
      "PEDRO": {
        "QUI": ["6F", "6F", "3F", "3G", "3E", "3G", "1I"],
        "SEX": ["1I", "3F", "3E"],
      },
      "RAUL": {
        "TER": ["1H", "1H"],
      },
      "REGIANE": {
        "TER": ["3B", "3B"],
        "QUA": ["3A", "3A"],
      },
      "REGINA": {
        "SEG": ["9D", "9D", "7C", "7C", "8D", "8D"],
        "TER": ["9B", "9B", "9C", "9C", "9A", "9A"],
        "QUA": ["8E/R", "8E/R", "1G/R", "1G/R", "6E", "6E"],
        "QUI": ["7D/R", "6E", "6E", "8A/R", "8C/R", "8C/R"],
        "SEX": ["1A", "1A", "7D", "7B", "7B", "8B", "8B", "8A"],
      },
      "ROBERTO": {
        "SEG": ["7E", "7F", "7C", "7D"],
        "TER": ["7F", "7C", "7D", "7B", "7F", "7C", "3G"],
        "QUA": ["7B", "7E", "7C", "7D", "7B", "7F", "1I/EF", "1I/EF", "3G/F", "2H/EF", "2H/EF"],
        "QUI": ["7E", "7F", "7E"],
        "SEX": ["7B", "7D", "7C", "7E", "7D", "7B"],
      },
      "RODRIGO": {
        "SEG": ["1D", "1D", "1C", "1C", "1F", "1F", "", "3D", "2G", "2F", "2H", "3G"],
        "TER": ["1B", "1B", "1A", "1A", "1E", "1E", "3F", "2G", "1I"],
        "QUA": ["3D", "3G", "3E"],
        "QUI": ["1I", "3F", "2H"],
        "SEX": ["3E", "2F"],
      },
      "ROSANGELA": {
        "SEG": ["1B", "1B", "2A", "2A", "2E", "2E"],
        "TER": ["1A", "1A", "1C", "1C", "2B", "2B"],
        "QUA": ["2A/PR", "2A/PR", "3A/PR", "3A/PR", "2C/Q", "2C/Q", "1G", "1G"],
        "QUI": ["3B/EM", "3B/EM", "2D/QU", "2D/QU", "2B/PR", "2B/PR"],
        "SEX": ["3B/P", "3B/P", "3A/EM", "3C/P", "3C/P", "3A/EM"],
      },
      "ROSE": {
        "SEG": ["6C", "1B"],
        "TER": ["6B", "6A", "1A", "6C"],
        "QUA": ["6D", "6A", "6D", "6D", "1B", "6B"],
        "QUI": ["6A", "6A", "6B", "1A", "6C", "1B"],
        "SEX": ["1A", "6B", "6C", "1A", "1B", "6D"],
      },
      "SANDRA": {
        "QUI": ["1H/F", "1H/G", "1H/G"],
      },
      "SELMA": {
        "SEG": ["1A", "1D", "1C"],
        "TER": ["1G/F"],
        "QUA": ["1B"],
        "QUI": ["1A", "1C", "1B", "1D", "1G/F"],
      },
      "SOL": {
        "SEG": ["X", "X", "X", "X", "X", "X"],
        "QUA": ["X", "X", "X", "X", "X", "X"],
        "QUI": ["X", "X", "X", "X", "X", "X"],
        "SEX": ["X", "X", "X", "X", "X", "X"],
      },
      "SOLL": {
        "TER": ["X", "X", "X", "X", "X", "X"],
      },
      "SUZY": {
        "SEG": ["1H", "2F", "2G"],
        "TER": ["6F", "6F", "1I", "2H"],
        "QUA": ["2ADM", "2ADM", "2B", "2B", "2E", "2E", "6E"],
        "QUI": ["2C", "2C", "2A", "2A", "2D", "2D", "6E", "1G", "1G"],
      },
      "SÉRGIO": {
        "SEG": ["2A", "3B", "3A", "2B", "2A", "3B", "2F", "3D", "3E"],
        "TER": ["3A", "2B", "3F", "2G", "3G", "1I"],
        "QUA": ["3F", "2F", "1I", "3D", "2G"],
        "QUI": ["3E", "2H", "2H", "3G"],
      },
      "TITO": {
        "SEG": ["6D", "7A", "7F", "7F", "7A", "7B", "7B"],
        "QUI": ["3C", "6C"],
        "SEX": ["6B", "6A", "6D", "6C", "6A", "6B", "6F", "6F", "6E", "6E", "7E", "7E", ""],
      },
      "VANDERSON": {
        "SEG": ["3A", "3A", "3C", "3C", "3B"],
        "TER": ["3C", "3C"],
        "QUA": ["2E/R", "2E/R", "3B", "3B", "3B"],
        "QUI": ["3C", "3C", "3A", "3A"],
        "SEX": ["3C", "3C", "3B/IN", "3B/IN"],
      },
      "VANIA": {
        "SEG": ["8D", "8C", "8C", "8A", "8A", "7E"],
        "TER": ["8B", "8B", "7F", "7E", "7E", "8A"],
        "QUA": ["3C", "3C", "7F", "7F", "8A", "7E", "9A/OP", "9A/OP"],
        "QUI": ["8E", "8B", "8B", "8D", "8D", "8E"],
        "SEX": ["8D", "8E", "8E", "7F", "8C", "8C"],
      },
      "VIVIANE": {
        "SEG": ["6B", "1B", "6B", "3A", "1D", "7B/T", "8B/PV", "9D/PV", "7D/T", "7F/T", "7F/T"],
        "TER": ["6C", "1F", "1E", "1B", "6C", "1C", "6F/T", "7F/R", "6F/T", "7F/PV", "7A/T", "7F/R"],
        "QUA": ["1D", "6D", "6A", "1F", "1C", "3A", "7E/T", "7C/T", "7A/R", "7A/R", "7C/T", "7B/T", "1H/R", "1H/P", "1H/P"],
        "QUI": ["1E", "7E"],
        "SEX": ["6A", "6D", "7E/R", "6E/T", "7E/R", "7A/T", "6E/T", "7D/T", "1H/P", "1H/P", "1H/R"],
      },
      "WILSON": {
        "TER": ["6E", "8C", "6E"],
        "QUA": ["6F", "8D", "8A", "6F"],
        "QUI": ["8E", "8B"],
      },
      "WILTON": {
        "SEG": ["7D/EF", "8A/T"],
        "TER": ["8E/T", "8C/EF", "8D/EF", "8D/EF", "8B/T", "8C/T"],
        "QUA": ["8B/T", "8C/T", "8B/EF", "8A/T", "8E/T", "8B/EF"],
        "QUI": ["8D/T", "8C/EF", "8D/T", "7C/EF", "7D/EF", "7C/EF"],
      },
    };

    // Dias da semana
    const diasSemana = ["DOM", "SEG", "TER", "QUA", "QUI", "SEX", "SAB"];

    // Agendamentos e histórico (incluindo agendamentos excluídos)
    const agendamentos = {};
    const historicoExcluidos = [];

    const monthNames = [
      "Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
      "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
    ];

    const weekdays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];

    const monthSelect = document.getElementById('monthSelect');
    const yearSelect = document.getElementById('yearSelect');
    let selectedDay = null;
    let selectedDate = null;
    let aulasSelecionadas = [];

    // Variáveis para o calendário pop-up
    let currentPopupDate = new Date();
    let popupSelectedDate = null;

    // Função para verificar conflito de agendamento
    function verificarConflitoAgendamento(turma, data, aula) {
      const [dia, mes, ano] = data.split('/');
      const key = `${ano}-${mes}`;
      
      if (!agendamentos[key]) return false;
      
      return agendamentos[key].some(agendamento => 
        agendamento.dia === parseInt(dia) && 
        agendamento.turma === turma && 
        agendamento.aula === aula
      );
    }

    // Funções do formulário
    function atualizarMarca() {
      const tipo = document.getElementById("aparelho").value;
      document.getElementById("marca").value = marcas[tipo] || "";
    }

    function atualizarSala() {
      const turma = document.getElementById("studentClass").value;
      const periodo = turma.includes("MANHA") ? "MANHA" : 
                     turma.includes("TARDE") ? "TARDE" : 
                     turma.includes("NOITE") ? "NOITE" : "";
      
      // Verifica se a turma existe no mapeamento
      if (salasPorTurmaPeriodo[turma]) {
        document.getElementById("sala").value = salasPorTurmaPeriodo[turma];
      } else {
        document.getElementById("sala").value = "Sala não definida";
      }
      
      // Verifica se há conflito de agendamento
      verificarConflito();
    }

    function abrirRelogio(idCampo) {
      const campo = document.getElementById(idCampo);
      if (campo && typeof campo.showPicker === 'function') {
        campo.showPicker();
      } else {
        campo.focus();
      }
    }

    function atualizarEmail() {
      const nome = document.getElementById("professor").value;
      document.getElementById("email-professor").value = teacherEmails[nome] || "";
    }

    function gerarOpcoesProfessores() {
      const select = document.getElementById("professor");
      Object.keys(teacherEmails).forEach(nome => {
        const option = document.createElement("option");
        option.value = nome;
        option.textContent = nome;
        select.appendChild(option);
      });
    }

    // Função para verificar conflito quando os campos relevantes mudam
    function verificarConflito() {
      const turma = document.getElementById("studentClass").value;
      const data = document.getElementById("data-selecionada").value;
      const conflictMessage = document.getElementById("conflictMessage");
      
      if (turma && data && aulasSelecionadas.length > 0) {
        const conflito = aulasSelecionadas.some(aula => 
          verificarConflitoAgendamento(turma, data, aula)
        );
        conflictMessage.style.display = conflito ? "block" : "none";
      } else {
        conflictMessage.style.display = "none";
      }
    }

    // Função para verificar disponibilidade do professor
    function verificarDisponibilidadeProfessor() {
      const professor = document.getElementById("professor").value;
      const turma = document.getElementById("studentClass").value;
      const scheduleContainer = document.getElementById("teacherSchedule");
      
      if (!professor || !turma) {
        scheduleContainer.style.display = "none";
        return;
      }
      
      const manhaList = document.getElementById("manhaSchedule");
      const tardeList = document.getElementById("tardeSchedule");
      const noiteList = document.getElementById("noiteSchedule");
      
      // Limpar listas
      manhaList.innerHTML = "";
      tardeList.innerHTML = "";
      noiteList.innerHTML = "";
      
      // Preencher listas
      if (horariosProfessores[professor]) {
        if (horariosProfessores[professor]["SEG"] && horariosProfessores[professor]["SEG"].length > 0) {
          horariosProfessores[professor]["SEG"].forEach(aula => {
            const li = document.createElement("li");
            li.textContent = aula;
            manhaList.appendChild(li);
          });
        } else {
          manhaList.innerHTML = "<li>Sem aulas</li>";
        }
        
        if (horariosProfessores[professor]["TER"] && horariosProfessores[professor]["TER"].length > 0) {
          horariosProfessores[professor]["TER"].forEach(aula => {
            const li = document.createElement("li");
            li.textContent = aula;
            tardeList.appendChild(li);
          });
        } else {
          tardeList.innerHTML = "<li>Sem aulas</li>";
        }
        
        if (horariosProfessores[professor]["QUA"] && horariosProfessores[professor]["QUA"].length > 0) {
          horariosProfessores[professor]["QUA"].forEach(aula => {
            const li = document.createElement("li");
            li.textContent = aula;
            noiteList.appendChild(li);
          });
        } else {
          noiteList.innerHTML = "<li>Sem aulas</li>";
        }
        
        scheduleContainer.style.display = "block";
      } else {
        scheduleContainer.style.display = "none";
      }
    }

    // Função para determinar o período da aula
    function determinarPeriodo(aula) {
      if (aula.includes("MANHA") || aula.includes("MANHÃ")) return "MANHÃ";
      if (aula.includes("TARDE")) return "TARDE";
      if (aula.includes("NOITE")) return "NOITE";
      return "INDEFINIDO";
    }

    // Função para obter classe CSS do período
    function getClassePeriodo(periodo) {
      switch(periodo) {
        case "MANHÃ": return "periodo-manha";
        case "TARDE": return "periodo-tarde";
        case "NOITE": return "periodo-noite";
        default: return "periodo-indefinido";
      }
    }

    // Nova função para atualizar aulas disponíveis baseada na data selecionada
    function atualizarAulasDisponiveis() {
      const professor = document.getElementById("professor").value;
      const dataSelecionada = document.getElementById("data-selecionada").value;
      const aulaInfo = document.getElementById("aula-info");
      const aulasContainer = document.getElementById("aulas-container");
      
      // Limpar seleção anterior
      aulasContainer.innerHTML = "";
      
      if (!professor || professor === "Selecione" || !dataSelecionada) {
        aulaInfo.innerHTML = '<span class="aula-indisponivel">Selecione um professor e uma data para ver as aulas disponíveis</span>';
        return;
      }
      
      // Converter data para objeto Date e obter dia da semana
      const [dia, mes, ano] = dataSelecionada.split('/');
      const dataObj = new Date(parseInt(ano), parseInt(mes) - 1, parseInt(dia));
      const diaSemana = dataObj.getDay(); // 0 = Domingo, 1 = Segunda, etc.
      const diasSemanaAbrev = ["DOM", "SEG", "TER", "QUA", "QUI", "SEX", "SAB"];
      const diaSemanaStr = diasSemanaAbrev[diaSemana];
      
      // Verificar se o professor tem aulas neste dia da semana
      if (!horariosProfessores[professor] || !horariosProfessores[professor][diaSemanaStr]) {
        aulaInfo.innerHTML = `<span class="aula-indisponivel">Professor não possui aulas na ${diaSemanaStr}</span>`;
        return;
      }
      
      const aulasDisponiveis = horariosProfessores[professor][diaSemanaStr];
      
      if (aulasDisponiveis.length === 0) {
        aulaInfo.innerHTML = `<span class="aula-indisponivel">Professor não possui aulas na ${diaSemanaStr}</span>`;
        return;
      }
      
      // Mostrar informações do dia da semana
      aulaInfo.innerHTML = `
        <div class="day-of-week">${diaSemanaStr} - ${dataSelecionada}</div>
      `;
      
      // Agrupar aulas por período
      const aulasPorPeriodo = {};
      aulasDisponiveis.forEach(aula => {
        if (aula && aula.trim() !== "") {
          const periodo = determinarPeriodo(aula);
          if (!aulasPorPeriodo[periodo]) {
            aulasPorPeriodo[periodo] = [];
          }
          aulasPorPeriodo[periodo].push(aula);
        }
      });
      
      // Criar botões para cada aula disponível agrupada por período
      Object.keys(aulasPorPeriodo).forEach(periodo => {
        const periodoDiv = document.createElement("div");
        periodoDiv.className = "periodo-container";
        
        const periodoTitle = document.createElement("div");
        periodoTitle.className = `periodo-titulo ${getClassePeriodo(periodo)}`;
        periodoTitle.textContent = periodo;
        periodoDiv.appendChild(periodoTitle);
        
        const aulasPeriodoDiv = document.createElement("div");
        aulasPeriodoDiv.className = "aulas-periodo";
        
        aulasPorPeriodo[periodo].forEach(aula => {
          const aulaBtn = document.createElement("div");
          aulaBtn.className = aulasSelecionadas.includes(aula) ? "aula-selecionada" : "aula-disponivel";
          aulaBtn.textContent = aula;
          aulaBtn.onclick = () => selecionarAula(aula, aulaBtn);
          aulasPeriodoDiv.appendChild(aulaBtn);
        });
        
        periodoDiv.appendChild(aulasPeriodoDiv);
        aulasContainer.appendChild(periodoDiv);
      });
    }

    // Função para selecionar uma aula
    function selecionarAula(aula, elemento) {
      const index = aulasSelecionadas.indexOf(aula);
      
      if (index === -1) {
        // Adicionar aula selecionada
        aulasSelecionadas.push(aula);
        elemento.classList.remove('aula-disponivel');
        elemento.classList.add('aula-selecionada');
      } else {
        // Remover aula selecionada
        aulasSelecionadas.splice(index, 1);
        elemento.classList.remove('aula-selecionada');
        elemento.classList.add('aula-disponivel');
      }
      
      // Verificar conflito
      verificarConflito();
    }

    // Função para obter agendamentos do mês
    function getAgendamentos(year, month) {
      const key = `${year}-${month + 1}`;
      return agendamentos[key] || [];
    }

    // Função para popular os seletores de mês e ano
    function populateMonthYearSelectors() {
      const currentDate = new Date();
      const currentYear = currentDate.getFullYear();
      const currentMonth = currentDate.getMonth();

      // Popular selector de mês
      monthNames.forEach((month, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = month;
        if (index === currentMonth) option.selected = true;
        monthSelect.appendChild(option);
      });

      // Popular selector de ano
      for (let year = currentYear - 2; year <= currentYear + 2; year++) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        if (year === currentYear) option.selected = true;
        yearSelect.appendChild(option);
      }
    }

    // Função para renderizar o corpo do calendário
    function renderCalendarBody(year, month) {
      const calendarBody = document.getElementById('calendarBody');
      calendarBody.innerHTML = '';

      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const today = new Date();
      const agendamentosDoMes = getAgendamentos(year, month);

      let date = 1;
      for (let i = 0; i < 6; i++) {
        const row = document.createElement('tr');
        
        for (let j = 0; j < 7; j++) {
          const cell = document.createElement('td');
          
          if (i === 0 && j < firstDay) {
            cell.textContent = '';
            cell.classList.add('indisponivel');
          } else if (date > daysInMonth) {
            cell.textContent = '';
            cell.classList.add('indisponivel');
          } else {
            cell.textContent = date;
            
            const cellDate = new Date(year, month, date);
            const isToday = cellDate.toDateString() === today.toDateString();
            const hasAgendamento = agendamentosDoMes.some(a => a.dia === date);
            
            if (isToday) {
              cell.classList.add('hoje');
            }
            
            if (hasAgendamento) {
              cell.classList.add('agendado');
            } else if (cellDate >= today) {
              cell.classList.add('disponivel');
            } else {
              cell.classList.add('indisponivel');
            }
            
            cell.addEventListener('click', () => selectDate(cell, date, month, year));
            date++;
          }
          
          row.appendChild(cell);
        }
        
        calendarBody.appendChild(row);
        if (date > daysInMonth) break;
      }

      // Atualizar seção de agendamentos
      atualizarSecaoAgendamentos(year, month);
    }

    // Função para atualizar a seção de agendamentos na parte inferior do calendário
    function atualizarSecaoAgendamentos(year, month) {
      const agendamentosLista = document.getElementById('agendamentos-lista');
      const agendamentosDoMes = getAgendamentos(year, month);
      
      if (agendamentosDoMes.length === 0) {
        agendamentosLista.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">Nenhum agendamento neste mês</p>';
        return;
      }
      
      // Ordenar agendamentos por data
      const agendamentosOrdenados = agendamentosDoMes.sort((a, b) => a.dia - b.dia);
      
      agendamentosLista.innerHTML = '';
      
      agendamentosOrdenados.forEach(agendamento => {
        const agendamentoDiv = document.createElement('div');
        agendamentoDiv.className = 'agendamento-item';
        
        const dataFormatada = `${agendamento.dia.toString().padStart(2, '0')}/${(month + 1).toString().padStart(2, '0')}/${year}`;
        const status = agendamento.horaEntrega ? 'entregue' : 'agendado';
        const statusText = agendamento.horaEntrega ? 'Entregue' : 'Agendado';
        
        agendamentoDiv.innerHTML = `
          <div class="agendamento-header">
            <div class="agendamento-data">${dataFormatada}</div>
            <div class="agendamento-status status-${status}">${statusText}</div>
          </div>
          <div class="agendamento-details">
            <div class="detail-item">
              <span class="detail-label">Professor:</span>
              <span class="detail-value">${agendamento.professor}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Turma:</span>
              <span class="detail-value">${agendamento.turma}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Aparelho:</span>
              <span class="detail-value">${agendamento.aparelho} (${agendamento.numAparelhos}x)</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Aula:</span>
              <span class="detail-value">${agendamento.aula}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Horário:</span>
              <span class="detail-value">${agendamento.horaRetirada} - ${agendamento.horaEntrega || 'Não entregue'}</span>
            </div>
          </div>
        `;
        
        agendamentosLista.appendChild(agendamentoDiv);
      });
    }

    // Função para selecionar data
    function selectDate(cell, day, month, year) {
      if (cell.classList.contains('indisponivel')) return;
      
      if (selectedDay) {
        selectedDay.classList.remove('selecionado');
        const agendamentosDoMes = getAgendamentos(parseInt(yearSelect.value), parseInt(monthSelect.value));
        if (!agendamentosDoMes.find(d => d.dia === parseInt(selectedDay.textContent))) {
          selectedDay.classList.add('disponivel');
        }
      }
      
      selectedDay = cell;
      selectedDate = new Date(year, month, day);
      cell.classList.remove('disponivel', 'agendado');
      cell.classList.add('selecionado');
      
      // Atualizar campo de data
      const dataFormatada = `${day.toString().padStart(2, '0')}/${(month + 1).toString().padStart(2, '0')}/${year}`;
      document.getElementById('data-selecionada').value = dataFormatada;
      
      // Atualizar aulas disponíveis
      atualizarAulasDisponiveis();
    }

    // Função para cadastrar agendamento
    function cadastrarAgendamento() {
      const professor = document.getElementById("professor").value;
      const aparelho = document.getElementById("aparelho").value;
      const numAparelhos = document.getElementById("numero-aparelhos").value;
      const turma = document.getElementById("studentClass").value;
      const horaRetirada = document.getElementById("hora-retirada").value;
      const horaEntrega = document.getElementById("hora-entrega").value;
      const data = document.getElementById("data-selecionada").value;
      
      if (!professor || professor === "Selecione" || !aparelho || !turma || !horaRetirada || !data || aulasSelecionadas.length === 0) {
        alert("Por favor, preencha todos os campos obrigatórios e selecione pelo menos uma aula.");
        return;
      }
      
      // Verificar conflito
      const conflito = aulasSelecionadas.some(aula => 
        verificarConflitoAgendamento(turma, data, aula)
      );
      
      if (conflito) {
        alert("CONFLITO: Já existe um agendamento para esta turma, data e uma das aulas selecionadas!");
        return;
      }
      
      const [dia, mes, ano] = data.split('/');
      const key = `${ano}-${mes}`;
      
      if (!agendamentos[key]) {
        agendamentos[key] = [];
      }
      
      // Criar um agendamento para cada aula selecionada
      aulasSelecionadas.forEach(aula => {
        const novoAgendamento = {
          dia: parseInt(dia),
          professor,
          aparelho,
          numAparelhos: parseInt(numAparelhos),
          turma,
          horaRetirada,
          horaEntrega,
          aula
        };
        
        agendamentos[key].push(novoAgendamento);
      });
      
      // Atualizar calendário
      renderCalendarBody(parseInt(ano), parseInt(mes) - 1);
      
      // Atualizar histórico
      atualizarHistorico();
      
      alert("Agendamento cadastrado com sucesso!");
      limparFormulario();
    }

    // Função para atualizar histórico
    function atualizarHistorico() {
      const historicoBody = document.getElementById("historico-body");
      historicoBody.innerHTML = "";
      
      // Combinar todos os agendamentos
      const todosAgendamentos = [];
      Object.keys(agendamentos).forEach(key => {
        const [ano, mes] = key.split('-');
        agendamentos[key].forEach(agendamento => {
          todosAgendamentos.push({
            ...agendamento,
            data: `${agendamento.dia.toString().padStart(2, '0')}/${mes.padStart(2, '0')}/${ano}`,
            mesAno: key
          });
        });
      });
      
      // Adicionar agendamentos excluídos
      historicoExcluidos.forEach(agendamento => {
        todosAgendamentos.push(agendamento);
      });
      
      // Ordenar por data (mais recente primeiro)
      todosAgendamentos.sort((a, b) => {
        const [diaA, mesA, anoA] = a.data.split('/');
        const [diaB, mesB, anoB] = b.data.split('/');
        const dataA = new Date(parseInt(anoA), parseInt(mesA) - 1, parseInt(diaA));
        const dataB = new Date(parseInt(anoB), parseInt(mesB) - 1, parseInt(diaB));
        return dataB - dataA;
      });
      
      todosAgendamentos.forEach((agendamento, index) => {
        const row = document.createElement("tr");
        
        if (agendamento.excluido) {
          row.classList.add("excluido");
        } else if (agendamento.horaEntrega) {
          row.classList.add("entregue");
        } else {
          row.classList.add("nao-entregue");
        }
        
        const statusEntrega = agendamento.horaEntrega ? "Entregue" : "Não entregue";
        const currentProfessor = document.getElementById("professor").value;
        const isOwner = agendamento.professor === currentProfessor && !agendamento.excluido;
        
        row.innerHTML = `
          <td>${agendamento.data}</td>
          <td>${agendamento.turma}</td>
          <td>${agendamento.numAparelhos}</td>
          <td>${agendamento.aparelho}</td>
          <td>${agendamento.professor}</td>
          <td>${agendamento.aula}</td>
          <td>${statusEntrega}</td>
          <td class="action-buttons">
            ${isOwner ? `<button class="btn-editar" onclick="editarAgendamento('${agendamento.mesAno}', ${agendamento.dia}, '${agendamento.turma}', '${agendamento.aula}')">✏️</button>` : ''}
            ${isOwner ? `<button class="btn-excluir" onclick="excluirAgendamento('${agendamento.mesAno}', ${agendamento.dia}, '${agendamento.turma}', '${agendamento.aula}')">🗑️</button>` : ''}
          </td>
        `;
        
        historicoBody.appendChild(row);
      });
    }

    // Função para excluir agendamento
    function excluirAgendamento(mesAno, dia, turma, aula) {
      if (!confirm("Tem certeza que deseja excluir este agendamento?")) {
        return;
      }
      
      const [ano, mes] = mesAno.split('-');
      
      if (agendamentos[mesAno]) {
        const index = agendamentos[mesAno].findIndex(agendamento => 
          agendamento.dia === dia && 
          agendamento.turma === turma && 
          agendamento.aula === aula
        );
        
        if (index !== -1) {
          const agendamentoExcluido = agendamentos[mesAno][index];
          agendamentoExcluido.excluido = true;
          agendamentoExcluido.data = `${dia.toString().padStart(2, '0')}/${mes.padStart(2, '0')}/${ano}`;
          
          // Remove do array de agendamentos ativos
          agendamentos[mesAno].splice(index, 1);
          
          // Adiciona ao histórico de excluídos
          historicoExcluidos.push({
            ...agendamentoExcluido,
            mesAno: mesAno
          });
          
          // Atualiza a exibição
          renderCalendarBody(parseInt(ano), parseInt(mes) - 1);
          atualizarHistorico();
        }
      }
    }
    
    // Função para editar agendamento (implementação básica)
    function editarAgendamento(mesAno, dia, turma, aula) {
      const [ano, mes] = mesAno.split('-');
      
      if (agendamentos[mesAno]) {
        const index = agendamentos[mesAno].findIndex(agendamento => 
          agendamento.dia === dia && 
          agendamento.turma === turma && 
          agendamento.aula === aula
        );
        
        if (index !== -1) {
          const agendamento = agendamentos[mesAno][index];
          
          // Preencher formulário com os dados do agendamento
          document.getElementById("professor").value = agendamento.professor;
          atualizarEmail();
          document.getElementById("aparelho").value = agendamento.aparelho;
          atualizarMarca();
          document.getElementById("numero-aparelhos").value = agendamento.numAparelhos;
          document.getElementById("studentClass").value = agendamento.turma;
          atualizarSala();
          document.getElementById("hora-retirada").value = agendamento.horaRetirada;
          document.getElementById("hora-entrega").value = agendamento.horaEntrega || "";
          
          // Definir data
          const dataFormatada = `${agendamento.dia.toString().padStart(2, '0')}/${mes.padStart(2, '0')}/${ano}`;
          document.getElementById('data-selecionada').value = dataFormatada;
          
          // Atualizar aulas disponíveis
          atualizarAulasDisponiveis();
          
          // Selecionar a aula específica
          aulasSelecionadas = [agendamento.aula];
          setTimeout(() => {
            const aulaBtns = document.querySelectorAll('.aula-disponivel');
            aulaBtns.forEach(btn => {
              if (btn.textContent === agendamento.aula) {
                btn.classList.remove('aula-disponivel');
                btn.classList.add('aula-selecionada');
              }
            });
          }, 100);
          
          // Remover o agendamento antigo
          agendamentos[mesAno].splice(index, 1);
          
          alert("Agendamento carregado para edição. Faça as alterações necessárias e clique em CADASTRAR.");
        }
      }
    }

    // Função para inicializar o datepicker
    function initDatepicker() {
      const datepickerInput = document.getElementById('data-selecionada');
      const datepickerPopup = document.getElementById('datepickerPopup');
      const prevMonthBtn = document.getElementById('prevMonth');
      const nextMonthBtn = document.getElementById('nextMonth');
      const monthYearTitle = document.getElementById('datepickerMonthYear');
      const weekdaysGrid = document.getElementById('datepickerWeekdays');
      const daysGrid = document.getElementById('datepickerDays');

      // Criar cabeçalho dos dias da semana
      weekdays.forEach(day => {
        const dayElement = document.createElement('div');
        dayElement.className = 'datepicker-weekday';
        dayElement.textContent = day;
        weekdaysGrid.appendChild(dayElement);
      });

      function renderDatepicker() {
        const year = currentPopupDate.getFullYear();
        const month = currentPopupDate.getMonth();
        
        monthYearTitle.textContent = `${monthNames[month]} ${year}`;
        
        // Limpar dias
        daysGrid.innerHTML = '';
        
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const today = new Date();
        
        // Dias do mês anterior
        const prevMonth = new Date(year, month, 0);
        const daysInPrevMonth = prevMonth.getDate();
        
        for (let i = firstDay - 1; i >= 0; i--) {
          const dayElement = document.createElement('div');
          dayElement.className = 'datepicker-day datepicker-other-month';
          dayElement.textContent = daysInPrevMonth - i;
          daysGrid.appendChild(dayElement);
        }
        
        // Dias do mês atual
        for (let day = 1; day <= daysInMonth; day++) {
          const dayElement = document.createElement('div');
          dayElement.className = 'datepicker-day';
          dayElement.textContent = day;
          
          const cellDate = new Date(year, month, day);
          
          if (cellDate.toDateString() === today.toDateString()) {
            dayElement.classList.add('datepicker-today');
          }
          
          if (cellDate < today) {
            dayElement.classList.add('disabled');
          }
          
          if (popupSelectedDate && 
              cellDate.toDateString() === popupSelectedDate.toDateString()) {
            dayElement.classList.add('selected');
          }
          
          dayElement.addEventListener('click', () => {
            if (!dayElement.classList.contains('disabled')) {
              // Remover seleção anterior
              document.querySelectorAll('.datepicker-day.selected').forEach(el => {
                el.classList.remove('selected');
              });
              
              // Selecionar novo dia
              dayElement.classList.add('selected');
              popupSelectedDate = new Date(year, month, day);
              
              // Atualizar input
              const dataFormatada = `${day.toString().padStart(2, '0')}/${(month + 1).toString().padStart(2, '0')}/${year}`;
              datepickerInput.value = dataFormatada;
              
              // Fechar popup
              datepickerPopup.classList.remove('active');
              
              // Atualizar calendário principal se necessário
              if (parseInt(monthSelect.value) !== month || parseInt(yearSelect.value) !== year) {
                monthSelect.value = month;
                yearSelect.value = year;
                renderCalendarBody(year, month);
              }
              
              // Selecionar no calendário principal
              selectDate(document.querySelector(`#calendarBody td:nth-child(${(firstDay + day - 1) % 7 + 1})`), day, month, year);
              
              // Atualizar aulas disponíveis
              atualizarAulasDisponiveis();
            }
          });
          
          daysGrid.appendChild(dayElement);
        }
        
        // Dias do próximo mês
        const totalCells = daysGrid.children.length;
        const remainingCells = 42 - totalCells; // 6 semanas * 7 dias
        
        for (let day = 1; day <= remainingCells; day++) {
          const dayElement = document.createElement('div');
          dayElement.className = 'datepicker-day datepicker-other-month';
          dayElement.textContent = day;
          daysGrid.appendChild(dayElement);
        }
      }

      // Event listeners
      datepickerInput.addEventListener('click', () => {
        datepickerPopup.classList.toggle('active');
        renderDatepicker();
      });

      prevMonthBtn.addEventListener('click', () => {
        currentPopupDate.setMonth(currentPopupDate.getMonth() - 1);
        renderDatepicker();
      });

      nextMonthBtn.addEventListener('click', () => {
        currentPopupDate.setMonth(currentPopupDate.getMonth() + 1);
        renderDatepicker();
      });

      // Fechar popup ao clicar fora
      document.addEventListener('click', (e) => {
        if (!datepickerInput.contains(e.target) && !datepickerPopup.contains(e.target)) {
          datepickerPopup.classList.remove('active');
        }
      });
    }

    function limparFormulario() {
      document.getElementById("professor").value = "Selecione";
      document.getElementById("email-professor").value = "";
      document.getElementById("aparelho").value = "";
      document.getElementById("marca").value = "";
      document.getElementById("numero-aparelhos").value = "1";
      document.getElementById("studentClass").value = "";
      document.getElementById("sala").value = "";
      document.getElementById("hora-retirada").value = "";
      document.getElementById("hora-entrega").value = "";
      document.getElementById("aula-info").innerHTML = '<span class="aula-indisponivel">Selecione um professor e uma data para ver as aulas disponíveis</span>';
      document.getElementById("aulas-container").innerHTML = "";
      document.getElementById("teacherSchedule").style.display = "none";
      aulasSelecionadas = [];
      
      // Limpa a seleção de data
      if (selectedDay) {
        selectedDay.classList.remove('selecionado');
        const agendamentosDoMes = getAgendamentos(parseInt(yearSelect.value), parseInt(monthSelect.value));
        if (!agendamentosDoMes.find(d => d.dia === parseInt(selectedDay.textContent))) {
          selectedDay.classList.add('disponivel');
        }
        selectedDay = null;
      }
      selectedDate = null;
      document.getElementById('data-selecionada').value = '';
      popupSelectedDate = null;
    }

    // Inicialização
    gerarOpcoesProfessores();
    populateMonthYearSelectors();
    renderCalendarBody(Number(yearSelect.value), Number(monthSelect.value));
    initDatepicker();

    // Adiciona listeners para verificar conflito quando os campos mudam
    document.getElementById("studentClass").addEventListener("change", verificarConflito);
    document.getElementById("data-selecionada").addEventListener("change", verificarConflito);

    monthSelect.addEventListener('change', () => {
      renderCalendarBody(Number(yearSelect.value), Number(monthSelect.value));
    });

    yearSelect.addEventListener('change', () => {
      renderCalendarBody(Number(yearSelect.value), Number(monthSelect.value));
    });
  </script>
</body>
</html>
